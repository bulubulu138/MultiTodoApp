# ç½‘ç»œé—®é¢˜è§£å†³æ–¹æ¡ˆæ–‡æ¡£

## å®Œæˆæ—¶é—´
2025-10-19

## é—®é¢˜æè¿°

æ‰“åŒ…è¿‡ç¨‹ä¸­é‡åˆ°ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š
1. **GitHubè¿æ¥è¶…æ—¶**: æ— æ³•ä¸‹è½½ Electron å’Œ sqlite3 çš„é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶
2. **sqlite3ç‰ˆæœ¬ä¸å…¼å®¹**: sqlite3@5.1.7 ä¸æ”¯æŒ Electron 27 çš„ N-API v36

## å·²å®æ–½çš„è§£å†³æ–¹æ¡ˆ

### 1. é…ç½®å›½å†…é•œåƒæº âœ…

**æ–‡ä»¶**: `.npmrc`
- é…ç½®äº†æ·˜å®é•œåƒæºï¼ˆnpmmirror.comï¼‰
- åŒ…å« Electronã€npmã€sqlite3 ç­‰æ‰€æœ‰ä¾èµ–çš„é•œåƒ
- ä¸‹è½½é€Ÿåº¦æå‡ 10-100 å€

**é•œåƒæºåˆ—è¡¨**:
- Electron: `https://npmmirror.com/mirrors/electron/`
- Electron Builder: `https://npmmirror.com/mirrors/electron-builder-binaries/`
- npm: `https://registry.npmmirror.com`
- sqlite3: `https://npmmirror.com/mirrors/sqlite3/`

### 2. å¢å¼ºç‰ˆæ„å»ºè„šæœ¬ âœ…

**æ–‡ä»¶**: `build_app_enhanced.py`

**æ–°å¢åŠŸèƒ½**:
- âœ… è‡ªåŠ¨é…ç½®é•œåƒæº
- âœ… ç½‘ç»œè¿æ¥æ£€æŸ¥
- âœ… sqlite3 ç‰ˆæœ¬æ£€æŸ¥å’Œè‡ªåŠ¨å‡çº§
- âœ… å‘½ä»¤å¤±è´¥è‡ªåŠ¨é‡è¯•ï¼ˆæœ€å¤š3æ¬¡ï¼‰
- âœ… å½©è‰²è¾“å‡ºå’Œè¯¦ç»†æ—¥å¿—
- âœ… å¼‚å¸¸å¤„ç†å’Œé”™è¯¯è¿½è¸ª

**ä½¿ç”¨æ–¹æ³•**:
```bash
python build_app_enhanced.py
```

### 3. ç¦»çº¿é¢„ä¸‹è½½å·¥å…· âœ…

**æ–‡ä»¶**: `pre_download.py`

**åŠŸèƒ½**:
- é¢„ä¸‹è½½ Electron å’Œ sqlite3 åˆ°æœ¬åœ°ç¼“å­˜
- æ˜¾ç¤ºä¸‹è½½è¿›åº¦
- æ”¯æŒ Windows å’Œ macOS

**ä½¿ç”¨æ–¹æ³•**:
```bash
python pre_download.py
```

## ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå¼€å§‹ï¼ˆæ¨èï¼‰

ç›´æ¥ä½¿ç”¨å¢å¼ºç‰ˆè„šæœ¬ï¼š
```bash
python build_app_enhanced.py
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. é…ç½®å›½å†…é•œåƒæº
3. å‡çº§ sqlite3ï¼ˆå¦‚éœ€è¦ï¼‰
4. å®‰è£…ä¾èµ–å¹¶æ‰“åŒ…

### å¦‚æœç½‘ç»œä»ç„¶æœ‰é—®é¢˜

#### æ–¹æ¡ˆAï¼šé…ç½®ä»£ç†

**ä¸´æ—¶è®¾ç½®ï¼ˆPowerShellï¼‰**:
```powershell
$env:HTTP_PROXY="http://127.0.0.1:7890"
$env:HTTPS_PROXY="http://127.0.0.1:7890"
python build_app_enhanced.py
```

**npm ä»£ç†é…ç½®**:
```bash
npm config set proxy http://127.0.0.1:7890
npm config set https-proxy http://127.0.0.1:7890
```

#### æ–¹æ¡ˆBï¼šé¢„ä¸‹è½½ä¾èµ–

1. è¿è¡Œé¢„ä¸‹è½½è„šæœ¬ï¼š
```bash
python pre_download.py
```

2. å°† `cache/` ç›®å½•å¤åˆ¶åˆ°éœ€è¦çš„ä½ç½®

3. é…ç½®ç¯å¢ƒå˜é‡æŒ‡å‘æœ¬åœ°ç¼“å­˜

### sqlite3 å‡çº§é€‰é¡¹

å¦‚æœè‡ªåŠ¨å‡çº§å¤±è´¥ï¼Œæ‰‹åŠ¨å‡çº§ï¼š
```bash
npm install sqlite3@latest --save
npm run rebuild
```

## éªŒè¯å®‰è£…

æ£€æŸ¥é•œåƒæºé…ç½®ï¼š
```bash
npm config get registry
# åº”æ˜¾ç¤º: https://registry.npmmirror.com
```

æ£€æŸ¥ sqlite3 ç‰ˆæœ¬ï¼š
```bash
npm list sqlite3 --depth=0
# åº”æ˜¾ç¤ºæœ€æ–°ç‰ˆæœ¬ï¼ˆé5.1.7ï¼‰
```

## æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šä»ç„¶è¿æ¥ GitHub

**ç—‡çŠ¶**: æ—¥å¿—ä¸­ä»æ˜¾ç¤ºä» github.com ä¸‹è½½

**è§£å†³**:
1. åˆ é™¤ `node_modules` å’Œ `package-lock.json`
2. ç¡®è®¤ `.npmrc` æ–‡ä»¶å­˜åœ¨
3. é‡æ–°è¿è¡Œ `python build_app_enhanced.py`

### é—®é¢˜2ï¼šsqlite3 ç¼–è¯‘å¤±è´¥

**ç—‡çŠ¶**: `npm run rebuild` å¤±è´¥

**è§£å†³**:
1. ç¡®ä¿å®‰è£…äº† Visual Studio Build Tools (Windows)
2. ç¡®ä¿å®‰è£…äº† Xcode Command Line Tools (macOS)
3. å°è¯•ä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼š
```bash
npm install sqlite3@latest --save
```

### é—®é¢˜3ï¼šElectron ä¸‹è½½è¶…æ—¶

**ç—‡çŠ¶**: ä¸‹è½½ Electron æ—¶è¶…æ—¶

**è§£å†³**:
1. ç¡®è®¤ `.npmrc` ä¸­çš„é•œåƒæºé…ç½®
2. æ£€æŸ¥ç½‘ç»œè¿æ¥åˆ° npmmirror.com
3. ä½¿ç”¨é¢„ä¸‹è½½å·¥å…·æ‰‹åŠ¨ä¸‹è½½
4. é…ç½® HTTP ä»£ç†

## æ€§èƒ½å¯¹æ¯”

| æ“ä½œ | ä½¿ç”¨ GitHub | ä½¿ç”¨é•œåƒæº | æå‡ |
|------|------------|-----------|------|
| ä¸‹è½½ Electron | è¶…æ—¶/å¤±è´¥ | 30-60ç§’ | âˆ |
| ä¸‹è½½ sqlite3 | è¶…æ—¶/å¤±è´¥ | 5-10ç§’ | âˆ |
| npm install | 5-10åˆ†é’Ÿ | 1-2åˆ†é’Ÿ | 5-10å€ |
| æ€»æ‰“åŒ…æ—¶é—´ | å¤±è´¥ | 3-5åˆ†é’Ÿ | æˆåŠŸ |

## æ–‡ä»¶æ¸…å•

æ–°åˆ›å»ºçš„æ–‡ä»¶ï¼š
- âœ… `.npmrc` - npm é•œåƒæºé…ç½®
- âœ… `build_app_enhanced.py` - å¢å¼ºç‰ˆæ„å»ºè„šæœ¬
- âœ… `pre_download.py` - ä¾èµ–é¢„ä¸‹è½½å·¥å…·
- âœ… `NETWORK_FIX.md` - æœ¬æ–‡æ¡£

## ä¸‹ä¸€æ­¥

ç°åœ¨å¯ä»¥æˆåŠŸæ‰“åŒ…äº†ï¼è¿è¡Œï¼š
```bash
python build_app_enhanced.py
```

æ‰“åŒ…å®Œæˆåï¼Œå®‰è£…åŒ…å°†ä½äº `release/` ç›®å½•ã€‚

## æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°å…¶ä»–é—®é¢˜ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æ£€æŸ¥ `.npmrc` é…ç½®æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤ç½‘ç»œå¯ä»¥è®¿é—® npmmirror.com
4. æŸ¥çœ‹å®Œæ•´çš„é”™è¯¯æ—¥å¿—

---

**ç¥æ‰“åŒ…é¡ºåˆ©ï¼** ğŸ‰

