# 待办关系功能使用指南

## 功能概述

待办关系功能允许您在不同的待办事项之间建立有向关联，帮助您更好地组织和理解工作的上下文关系。

## 关系类型

### 1. 背景关系 (Background) 📋
**含义**: A 是 B 的背景 → A 为 B 提供了前置背景和上下文

**示例**:
```
市场调研 --背景--> 产品开发
竞品分析 --背景--> 产品开发
```
**使用场景**: 当一个待办事项需要基于另一个待办的成果时

### 2. 延伸关系 (Extends) 📝
**含义**: A 延伸于 B → A 是 B 的延续和深化

**示例**:
```
需求文档 --延伸--> 市场调研
技术方案 --延伸--> 需求文档
```
**使用场景**: 当一个待办是另一个待办的后续工作时

### 3. 并列关系 (Parallel) ⚡
**含义**: A 和 B 是并列的 → A 和 B 是同一项目的并行任务

**示例**:
```
前端开发 ⚡ 后端开发
UI设计 ⚡ 文档编写
```
**使用场景**: 当多个待办可以同时进行，且属于同一个大任务时

## 使用方法

### 方法一：在 RelationsModal 中管理关系

#### 1. 打开关系管理对话框

1. 在待办列表中找到目标待办
2. 点击待办卡片底部的**"关联"**按钮
3. 打开关系管理对话框

#### 2. 添加新关系

1. 在对话框顶部选择关系类型：
   - 📋 背景
   - 📝 延伸
   - ⚡ 并列

2. 点击**"+ 添加关联"**按钮

3. 在搜索对话框中：
   - 输入关键词搜索待办
   - 或浏览待办列表
   - 点击目标待办

4. 关系创建成功！

#### 3. 查看关系

**时间轴视图** (Timeline):
- 按时间顺序展示所有关联的待办
- 当前待办会高亮显示
- 显示每个待办的状态和关系类型

**列表视图** (List):
- 分组展示不同类型的关系
- 显示关联待办的详细信息
- 快速定位特定类型的关系

切换视图：点击右上角的**时间轴/列表**按钮

#### 4. 删除关系

1. 在关系列表中找到要删除的关系
2. 点击**"删除"**按钮
3. 确认删除

### 方法二：在编辑页面查看关联上下文

#### 1. 打开编辑对话框

1. 点击待办的**"编辑"**按钮
2. 如果待办有关联，右侧会自动显示关联上下文面板

#### 2. 关联上下文面板

面板从上到下显示：

```
┌─────────────────────────────┐
│ 📋 背景事项 (2)             │
│   ├─ 市场调研 ✅            │
│   └─ 竞品分析 ✅            │
├─────────────────────────────┤
│ 📝 延续工作 (1)             │
│   └─ 需求文档 ⏳            │
├─────────────────────────────┤
│ 🎯 当前待办                 │
│   └─ 产品开发 ⏳ ⬅ 当前   │
├─────────────────────────────┤
│ ⚡ 并列事项 (2)             │
│   ├─ UI设计 ⏳              │
│   └─ 文档编写 📋            │
└─────────────────────────────┘
```

**功能**:
- 展开/收起各个分组
- 查看完整的工作上下文
- 快速了解待办的来龙去脉

#### 3. 优势

- ✅ 编辑时一目了然看到关联
- ✅ 不用切换窗口
- ✅ 帮助保持工作连贯性

### 方法三：在待办列表中查看上下文

#### 1. 展开关联上下文

1. 在待办卡片底部找到**"查看上下文"**按钮
2. 点击展开关联面板
3. 紧凑模式显示关联信息

#### 2. 收起上下文

点击**"收起上下文"**按钮即可收起面板

#### 3. 优势

- ✅ 不离开列表页
- ✅ 快速浏览关联
- ✅ 紧凑显示，节省空间

## 使用场景

### 场景一：项目管理

**项目**: 开发新产品

```
1. 市场调研 (已完成) ✅
   ↓ [背景]
2. 竞品分析 (已完成) ✅
   ↓ [背景]
3. 产品开发 (进行中) ⏳
   ├─ [并列] → UI设计 (进行中) ⏳
   ├─ [并列] → 后端开发 (进行中) ⏳
   └─ [并列] → 文档编写 (待办) 📋
```

**操作步骤**:
1. 创建"产品开发"待办
2. 添加"市场调研"作为背景
3. 添加"竞品分析"作为背景
4. 添加"UI设计"、"后端开发"、"文档编写"为并列任务

**收益**:
- 清晰的项目结构
- 了解每个任务的前置条件
- 并行任务一目了然

### 场景二：学习计划

**目标**: 学习 React

```
1. JavaScript 基础 (已完成) ✅
   ↓ [背景]
2. ES6 特性 (已完成) ✅
   ↓ [延伸]
3. React 基础 (进行中) ⏳
   ├─ [延伸] → React Hooks (待办) 📋
   └─ [延伸] → React Router (待办) 📋
```

**操作步骤**:
1. 完成基础知识
2. 建立学习路径的延伸关系
3. 按顺序逐步深入

**收益**:
- 清晰的学习路径
- 避免遗漏前置知识
- 合理安排学习顺序

### 场景三：生活规划

**目标**: 准备搬家

```
1. 找房子 (已完成) ✅
   ↓ [背景]
2. 搬家准备 (进行中) ⏳
   ├─ [并列] → 打包物品 (进行中) ⏳
   ├─ [并列] → 预约搬家公司 (待办) 📋
   ├─ [并列] → 办理水电 (待办) 📋
   └─ [并列] → 更新地址 (待办) 📋
```

**操作步骤**:
1. 创建总任务"搬家准备"
2. 添加所有并行子任务
3. 标记"找房子"为背景

**收益**:
- 不遗漏任何步骤
- 并行推进多个任务
- 跟踪整体进度

## 最佳实践

### 1. 合理使用关系类型

✅ **推荐**:
- 背景关系：用于前置条件和上下文
- 延伸关系：用于顺序推进的任务链
- 并列关系：用于可同时进行的任务

❌ **避免**:
- 过度使用关系，导致结构复杂
- 混淆关系类型的含义
- 创建循环引用（A→B→A）

### 2. 保持关系层级简洁

✅ **推荐**:
- 最多3-4层的关系链
- 单个待办不超过10个关系
- 清晰的层级结构

❌ **避免**:
- 过深的关系嵌套（5层以上）
- 过多的平行关系（10个以上）
- 混乱无序的关系网络

### 3. 定期维护关系

✅ **推荐做法**:
- 待办完成后检查关系是否还需要
- 定期清理过时的关系
- 保持关系的时效性

❌ **避免**:
- 关系堆积，从不清理
- 关联已删除的待办
- 保留无意义的历史关系

### 4. 利用关联上下文

✅ **推荐**:
- 编辑待办时查看右侧面板
- 开始新任务前查看背景
- 检查并列任务的进度

❌ **避免**:
- 忽视关联信息
- 脱离上下文独立工作
- 不查看前置条件

## 快捷操作

### 键盘快捷键（规划中）
- `Ctrl+R`: 打开关系管理
- `Ctrl+K`: 快速添加关系
- `Ctrl+Shift+R`: 查看关联上下文

### 批量操作（规划中）
- 批量添加并列关系
- 批量删除关系
- 复制关系结构

## 常见问题

### Q1: 如何知道一个待办有关系？
**A**: 查看待办卡片，如果有关系，"查看上下文"按钮会显示关联数量。

### Q2: 可以创建重复的关系吗？
**A**: 不可以。同样的 source、target 和关系类型只能创建一次。系统会提示"该关系已存在"。

### Q3: 删除待办后，关系会怎样？
**A**: 相关的所有关系会自动删除，不需要手动清理。

### Q4: 能否创建循环关系？
**A**: 理论上可以，但强烈不建议。这会导致逻辑混乱和显示问题。

### Q5: 背景和延伸有什么区别？
**A**: 
- **背景**: A 为 B 提供基础（B 依赖 A 的结果）
- **延伸**: B 是 A 的延续（B 深化 A 的内容）

### Q6: 并列关系是双向的吗？
**A**: 是的。A 并列 B 意味着 B 也并列 A，它们是对称的关系。

### Q7: 关系上下文面板为什么不显示？
**A**: 可能的原因：
- 待办没有任何关系
- 处于新建模式（而非编辑模式）
- 关系数据加载失败

### Q8: 如何查看所有关系？
**A**: 目前没有全局关系视图。需要逐个打开待办的关系管理对话框查看。

## 技巧和窍门

### 💡 技巧1: 使用背景关系记录决策依据
在重要决策后，创建新待办，将研究和分析作为背景关系添加。

### 💡 技巧2: 用延伸关系规划学习路径
将知识点串成链条，逐步深入学习。

### 💡 技巧3: 用并列关系分解大任务
将大任务分解为多个可并行的小任务，提高效率。

### 💡 技巧4: 在编辑时利用右侧面板
编辑待办时，右侧的关联上下文可以帮助你保持连贯性。

### 💡 技巧5: 使用时间轴查看项目进展
时间轴视图可以直观展示整个项目的时间线和进度。

## 数据安全

### 备份
- 关系数据包含在数据导出中
- 定期导出可以备份所有关系

### 恢复
- 导入数据时会同时恢复关系
- 关系依赖待办ID，请确保待办也已导入

### 隐私
- 所有数据存储在本地 SQLite 数据库
- 不会上传到任何服务器
- 完全离线使用

## 更新日志

### v1.0.0 (2025-10-18)
- ✅ 初始发布
- ✅ 支持三种关系类型
- ✅ RelationsModal 关系管理
- ✅ 编辑页面关联上下文面板
- ✅ 列表页面关联上下文展开
- ✅ 时间轴和列表两种视图
- ✅ 完整的 CRUD 操作
- ✅ 数据持久化

### 计划功能
- ⏳ 关系可视化图表
- ⏳ 智能关系推荐
- ⏳ 批量关系操作
- ⏳ 关系模板
- ⏳ 关系统计分析

## 反馈和建议

如果您有任何问题、建议或发现了 bug，欢迎反馈！

---

**版本**: 1.0.0
**更新日期**: 2025-10-18
**文档语言**: 简体中文

